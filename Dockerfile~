FROM golang:1.23-alpine

# Define o diretório de trabalho
WORKDIR /app

# Copia o arquivo .env e os arquivos do projeto para o contêiner
COPY .env .
COPY . .

# Instala as dependências de compilação, compila o binário e remove as dependências
RUN apk add --no-cache gcc musl-dev && \
    go build -o main cmd/server/main.go && \
    apk del gcc musl-dev

# Expõe a porta da aplicação
EXPOSE 8080

# Executa o binário
CMD ["./main"]